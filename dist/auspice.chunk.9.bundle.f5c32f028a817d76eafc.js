(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{TKye:function(t,e,n){"use strict";n.r(e);var r=n("q1tI"),o=n.n(r),i=n("LCzB"),a=n("AKWm"),c=(n("sQjb"),n("/MKj")),s=n("KmX0"),l=n("4k54"),u=n("VIqg"),p=n("RhHs"),f=n("FmoU"),y=n("44y/"),h=n("EjHT"),d=n("WjpJ"),v=n.n(d),m=n("vec1"),b=n("Rf7/"),g=n("Y6X2"),x=n("PAHG"),j=n("IzZ+");function O(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S=function(t,e){if(e&&e[t])return e[t].title;if(Object(g.d)(t)){var n=Object(g.a)(t);return n.aa?"Genotype at ".concat(n.gene," pos ").concat(n.positions.join(", ")):"Genotype at Nuc. ".concat(n.positions.join(", "))}return t},k=function(t,e,n){return e<n?t?"and normalized to 100% at each time point for ".concat(e," out of a total of ").concat(n," tips"):"as a fraction of all sequences at each time point showing ".concat(e," out of a total of ").concat(n," tips"):""},P=function(t,e){return{y:Object(u.a)().domain([0,e]).range([t.height-t.spaceBottom,t.spaceTop]),numTicksY:5}},A=function(t,e,n){!function(t){t.selectAll(".y.axis").remove()}(t);var r=Object(h.a)(".0%");t.append("g").attr("class","y axis").attr("transform","translate(".concat(e.spaceLeft,",0)")).style("font-family",m.b).style("font-size","12px").call(Object(p.b)(n.y).ticks(n.numTicksY).tickFormat(r))},R=function(t,e,n,r){if(n){!function(t){t.selectAll(".projection-pivot").remove(),t.selectAll(".projection-text").remove()}(t),t.append("g").attr("class","projection-pivot").append("line").attr("x1",e.x(parseFloat(n))).attr("x2",e.x(parseFloat(n))).attr("y1",e.y(1)).attr("y2",e.y(0)).style("visibility","visible").style("stroke","rgba(55,55,55,0.9)").style("stroke-width","2").style("stroke-dasharray","4 4");var o=.5*(e.x(parseFloat(n))+e.x.range()[1]);t.append("g").attr("class","projection-text").append("text").attr("x",o).attr("y",e.y(1)-3).style("pointer-events","none").style("fill","#555").style("font-family",m.b).style("font-size",12).style("alignment-baseline","bottom").style("text-anchor","middle").text(r("Projection"))}};function q(){Object(a.a)(this).attr("opacity",1)}function z(){Object(a.a)(this).attr("opacity",.85),Object(a.a)("#freqinfo").style("visibility","hidden"),Object(a.a)("#vline").style("visibility","hidden")}var E,F=function(t){var e=t.matrix,n=t.pivots,r=t.colorScale,o=function(t,e){for(var n=e.legendValues.filter((function(t){return void 0!==t})).reverse().map((function(t){return t.toString()})),r=n.length-1;r>=0;--r)-1===t.indexOf(n[r])&&n.splice(r,1);return t.length>n.length&&t.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n}(Object.keys(e),r),i=function(t,e,n){for(var r=[],o=0;o<t.length;o++){for(var i=[],a=0;a<e;a++)if(0===o)i.push([0,n[t[o]][a]]);else{var c=r[o-1][a][1];i.push([c,n[t[o]][a]+c])}r.push(i)}return r}(o,n.length,e),a=function(t){return t[t.length-1].reduce((function(t,e){return Math.max(t,e[1])}),0)}(i);return{categories:o,series:i,maxY:a}},G=function(t,e,n,r){var o,i=n.categories,c=n.series,s=r.colorBy,u=r.colorScale,p=r.colorOptions,h=r.pivots,d=r.projection_pivot,v=r.t;(o=t).selectAll("path").remove(),o.selectAll("line").remove(),o.selectAll("text").remove();var g=function(t,e){return function(n,r){return t[r]===b.c?"rgb(190, 190, 190)":Object(f.e)(e.scale(t[r])).toString()}}(i,u),j=function(t,e){return e.continuous?t.map((function(t){return t===b.c?b.c:"".concat(e.legendBounds[t][0].toFixed(2)," - ").concat(e.legendBounds[t][1].toFixed(2))})):t.slice()}(i,u),w=Object(y.a)().x((function(t,n){return e.x(h[n])})).y0((function(t){return e.y(t[0])})).y1((function(t){return e.y(t[1])}));t.selectAll(".stream").data(c).enter().append("path").attr("d",w).attr("fill",g).attr("opacity",.85).on("mouseover",q).on("mouseout",z).on("mousemove",(function(t,n){var r=O(Object(l.a)(this),1)[0],o=e.x.invert(r),i=h.reduce((function(t,e,n,r){return Math.abs(e-o)<Math.abs(r[t]-o)?n:t}),0),c=Math.round(100*(t[i][1]-t[i][0]))+"%",u=e.x(h[i]),f=e.y(t[i][1]),y=e.y(t[i][0]);Object(a.a)("#vline").style("visibility","visible").attr("x1",u).attr("x2",u).attr("y1",f).attr("y2",y);var b=u>.5*e.x.range()[1]?"":"".concat(u+25,"px"),g=u>.5*e.x.range()[1]?"".concat(e.x.range()[1]-u+25,"px"):"",w=f>.5*e.y(0)?"".concat(e.y(0)-50,"px"):"".concat(f+25,"px"),k=v("Frequency");d&&h[i]>d&&(k=v("Projected frequency")),Object(a.a)("#freqinfo").style("left",b).style("right",g).style("top",w).style("padding-left","10px").style("padding-right","10px").style("padding-top","0px").style("padding-bottom","0px").style("visibility","visible").style("background-color","rgba(55,55,55,0.9)").style("color","white").style("font-family",m.b).style("font-size",18).style("line-height",1).style("font-weight",300).html("<p>".concat(S(s,p),": ").concat(j[n],"</p>\n        <p>").concat(v("Time point"),": ").concat(Object(x.d)(h[i]),"</p>\n        <p>").concat(k,": ").concat(c,"</p>"))})),t.append("line").attr("id","vline").style("visibility","hidden").style("pointer-events","none").style("stroke","rgba(55,55,55,0.9)").style("stroke-width",4),function(t,e,n,r,o){var i=function(t,e,n,r){return t.map((function(t){for(var o=.15*n.y.domain()[1],i=0;i<t.length-r;i++){var a=i+r;if(t[i][1]-t[i][0]>o&&t[a][1]-t[a][0]>o)return[n.x(e[i+1]),(n.y((t[i][1]+t[i][0])/2)+n.y((t[a][1]+t[a][0])/2))/2]}return[void 0,void 0]}))}(e,n,o,3);t.selectAll(".streamLabels").data(r).enter().append("text").attr("x",(function(t,e){return i[e][0]})).attr("y",(function(t,e){return i[e][1]})).style("pointer-events","none").style("fill","white").style("font-family",m.b).style("font-size",14).style("alignment-baseline","middle").text((function(t,e){return i[e][0]?t:""}))}(t,c,h,j,e)};n("mvt5");function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){D(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H(t);if(e){var o=H(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M(this,n)}}function M(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var L=Object(c.b)((function(t){return{data:t.frequencies.data,pivots:t.frequencies.pivots,matrix:t.frequencies.matrix,nodes:t.tree.nodes,projection_pivot:t.frequencies.projection_pivot,version:t.frequencies.version,browserDimensions:t.browserDimensions.browserDimensions,colorBy:t.controls.colorBy,colorScale:t.controls.colorScale,colorOptions:t.metadata.colorings,normalizeFrequencies:t.controls.normalizeFrequencies}}))(E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(c,t);var e,n,r,i=I(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=i.call(this,t)).state={maxY:0},e}return e=c,(n=[{key:"calcChartGeom",value:function(t,e){return{width:t,height:e,spaceLeft:40,spaceRight:10,spaceBottom:20,spaceTop:10}}},{key:"recomputeRedrawAll",value:function(t,e){var n=this.calcChartGeom(e.width,e.height),r=F(_({},e));t.maxY=r.maxY,t.categories=r.categories;var o=function(t,e){return{x:Object(u.a)().domain([e[0],e[e.length-1]]).range([t.spaceLeft,t.width-t.spaceRight])}}(n,e.pivots),i=P(n,r.maxY);t.scales=_(_({},o),i),function(t,e,n){var r=n.x.domain(),o=n.x.range(),i=Object(j.b)(r[1]-r[0],o[1]-o[0]).majorStep;!function(t){t.selectAll(".x.axis").remove()}(t),t.append("g").attr("class","x axis").attr("transform","translate(0,".concat(e.height-e.spaceBottom,")")).style("font-family",m.b).style("font-size","12px").call(Object(p.a)(n.x).tickValues(v()(r[0],r[1],i)).tickFormat((function(t){return Object(j.c)(i,t)})))}(t.svg,n,o),A(t.svg,n,i),G(t.svgStreamGroup,t.scales,r,_({},e)),R(t.svg,t.scales,e.projection_pivot,e.t)}},{key:"recomputeRedrawPartial",value:function(t,e,n){var r,o,i=F(_({},n)),a=t.maxY!==i.maxY,c=(r=t.categories,o=i.categories,!(r.length===o.length&&!r.filter((function(t,e){return t!==o[e]})).length));if(!a&&!c)return!1;var s,l=this.calcChartGeom(n.width,n.height);if(a){var u=P(l,i.maxY);A(t.svg,l,u),s=_(_({},t.scales),u)}else s=_({},t.scales);return G(t.svgStreamGroup,s,i,_({},n)),a&&R(t.svg,s,n.projection_pivot,n.t),_(_({},t),{},{scales:s,maxY:i.maxY,categories:i.categories})}},{key:"componentDidMount",value:function(){var t=Object(a.a)(this.domRef),e=t.append("g"),n={svg:t,svgStreamGroup:e};this.props.matrix&&this.recomputeRedrawAll(n,this.props),this.setState(n)}},{key:"componentWillReceiveProps",value:function(t){if(this.props.version===t.version);else if(!this.props.loaded&&t.loaded){var e=_({},this.state);this.recomputeRedrawAll(e,t),this.setState(e)}else{var n=this.recomputeRedrawPartial(this.state,this.props,t);n&&this.setState(n)}}},{key:"componentDidUpdate",value:function(t){if(t.width!==this.props.width||t.height!==this.props.height){var e=_({},this.state);this.recomputeRedrawAll(e,this.props),this.setState(e)}}},{key:"render",value:function(){var t=this,e=this.props.t,n=this.props.nodes[0],r=n.tipCount,i=n.fullTipCount;return o.a.createElement(s.a,{title:"".concat(e("Frequencies")," (").concat(e("colored by")," ").concat(S(this.props.colorBy,this.props.colorOptions)," ").concat(e(k(this.props.normalizeFrequencies,r,i)),")")},o.a.createElement("div",{id:"freqinfo",style:{zIndex:20,position:"absolute",borderRadius:"5px",padding:"10px",backgroundColor:"hsla(0,0%,100%,.9)",pointerEvents:"none",visibility:"hidden",fontSize:"14px"}}),o.a.createElement("svg",{id:"d3frequenciesSVG",width:this.props.width,height:this.props.height,style:{pointerEvents:"auto",overflow:"visible"}},o.a.createElement("g",{ref:function(e){t.domRef=e},id:"d3frequencies"})))}}])&&B(e.prototype,n),r&&B(e,r),c}(o.a.Component))||E,V=Object(i.a)()(L);e.default=V},mvt5:function(t,e,n){var r=n("rph2");"string"==typeof r&&(r=[[t.i,r,""]]);n("ZuTH")(r,{});r.locals&&(t.exports=r.locals)},rph2:function(t,e,n){(t.exports=n("JPst")(!1)).push([t.i,'\n/* Variables - keep in sync with globalStyles.js*/\n:root {\n  --darkGrey: #333;\n  --medGrey: #888;\n}\n\n#d3entropy .overlay {\n  fill: none;\n  pointer-events: all;\n}\n\n#d3entropy .brush {\n  stroke: none;\n}\n\n#d3entropy .niceText {\n  font-family: "Lato", "Helvetica Neue", "Helvetica", "sans-serif";\n  font-size: 14px;\n  font-style: italic;\n  color: var(--medGrey);\n}\n\n.brush .selection {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n',""])}}]);